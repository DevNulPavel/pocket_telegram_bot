name: Docker publish
on:
    push:
        # Publish `main` as Docker `latest` image.
        branches:
            - main
        # Publish `v1.2.3` tags as releases.
        tags:
            - v*
    pull_request:
env:
jobs:
    # Push image to GitHub Packages.
    # See also https://docs.docker.com/docker-hub/builds/
    push:
        runs-on: ubuntu-latest
        if: github.event_name == 'push'
        steps:
            - uses: actions/checkout@v2

            - name: Build image
              run: docker build . --file dockerfile --tag $IMAGE_NAME

            - name: Log into registry
              run: docker login -u ${{ env.DOCKER_LOGIN }} -p ${{ env.DOCKER_PASSWORD }}

            - name: Push image
              run: |
                docker push devnul/pocket_telegram_bot:latest
